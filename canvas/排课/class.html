<!--
   20190211
   由于
-->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
   <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

  <title>Document</title>
</head>
<style>
table {
  text-align: center;
  width: 95%;
}
td {
  border: 1px solid blue;
  height: 25px;
}
.name {
   color:blue;
   width:100px;
   border:1px solid red;
}
.names {

}
</style>
<body>
  <h2>智能排课系统</h2>
  <div class="operations">
     操作
  <button id="refresh" class="btn btn-info">重排</button>
  <button  class="btn btn-info" data-toggle="modal" data-target="#exampleModal">添加学生</button>
  </div>
  <table class="table">
    <thead>
    <td class="name">
        时间
      </td>      
      <td class="name">
        周一
      </td>
      <td class="name">
          周二
      </td>
      <td class="name">
          周三
      </td>
      <td class="name">
          周四
      </td>
      <td class="name">
          周五
      </td>
      <td class="name">
          周六
      </td>
      <td class="name">
          周日
      </td>
    </thead>
    <tbody>
      <tr>
        <td class="text">
          9:00-10:00
        </td>
        <td class="name">
           &nbsp;&nbsp;&nbsp;&nbsp;
        </td>
        <td class="name">
            &nbsp;&nbsp;&nbsp;&nbsp;
         </td>
         <td class="name">
            &nbsp;&nbsp;&nbsp;&nbsp;
         </td>
         <td class="name">
            &nbsp;&nbsp;&nbsp;&nbsp;
         </td>
         <td class="name">
            &nbsp;&nbsp;&nbsp;&nbsp;
         </td>
         <td class="name">
            &nbsp;&nbsp;&nbsp;&nbsp;
         </td>
         <td class="name">
            &nbsp;&nbsp;&nbsp;&nbsp;
         </td>
      </tr>
      <tr>
          <td class="text">
            10:00-11:00
          </td>
          <td class="name">
             &nbsp;&nbsp;&nbsp;&nbsp;
          </td>
          <td class="name">
              &nbsp;&nbsp;&nbsp;&nbsp;
           </td>
           <td class="name">
              &nbsp;&nbsp;&nbsp;&nbsp;
           </td>
           <td class="name">
              &nbsp;&nbsp;&nbsp;&nbsp;
           </td>
           <td class="name">
              &nbsp;&nbsp;&nbsp;&nbsp;
           </td>
           <td class="name">
              &nbsp;&nbsp;&nbsp;&nbsp;
           </td>
           <td class="name">
              &nbsp;&nbsp;&nbsp;&nbsp;
           </td>
        </tr>
        <tr>
            <td class="text">
              11:00-12:00
            </td>
            <td class="name">
               &nbsp;&nbsp;&nbsp;&nbsp;
            </td>
            <td class="name">
                &nbsp;&nbsp;&nbsp;&nbsp;
             </td>
             <td class="name">
                &nbsp;&nbsp;&nbsp;&nbsp;
             </td>
             <td class="name">
                &nbsp;&nbsp;&nbsp;&nbsp;
             </td>
             <td class="name">
                &nbsp;&nbsp;&nbsp;&nbsp;
             </td>
             <td class="name">
                &nbsp;&nbsp;&nbsp;&nbsp;
             </td>
             <td class="name">
                &nbsp;&nbsp;&nbsp;&nbsp;
             </td>
          </tr>
          <tr>
              <td class="text">
                12:00-13:00
              </td>
              <td class="name">
                 &nbsp;&nbsp;&nbsp;&nbsp;
              </td>
              <td class="name">
                  &nbsp;&nbsp;&nbsp;&nbsp;
               </td>
               <td class="name">
                  &nbsp;&nbsp;&nbsp;&nbsp;
               </td>
               <td class="name">
                  &nbsp;&nbsp;&nbsp;&nbsp;
               </td>
               <td class="name">
                  &nbsp;&nbsp;&nbsp;&nbsp;
               </td>
               <td class="name">
                  &nbsp;&nbsp;&nbsp;&nbsp;
               </td>
               <td class="name">
                  &nbsp;&nbsp;&nbsp;&nbsp;
               </td>
            </tr>
            <tr>
                <td class="text">
                  13:00-14:00
                </td>
                <td class="name">
                   &nbsp;&nbsp;&nbsp;&nbsp;
                </td>
                <td class="name">
                    &nbsp;&nbsp;&nbsp;&nbsp;
                 </td>
                 <td class="name">
                    &nbsp;&nbsp;&nbsp;&nbsp;
                 </td>
                 <td class="name">
                    &nbsp;&nbsp;&nbsp;&nbsp;
                 </td>
                 <td class="name">
                    &nbsp;&nbsp;&nbsp;&nbsp;
                 </td>
                 <td class="name">
                    &nbsp;&nbsp;&nbsp;&nbsp;
                 </td>
                 <td class="name">
                    &nbsp;&nbsp;&nbsp;&nbsp;
                 </td>
            </tr>
            <tr>
                <td class="text">
                  14:00-15:00
                </td>
                <td class="name">
                   &nbsp;&nbsp;&nbsp;&nbsp;
                </td>
                <td class="name">
                    &nbsp;&nbsp;&nbsp;&nbsp;
                 </td>
                 <td class="name">
                    &nbsp;&nbsp;&nbsp;&nbsp;
                 </td>
                 <td class="name">
                    &nbsp;&nbsp;&nbsp;&nbsp;
                 </td>
                 <td class="name">
                    &nbsp;&nbsp;&nbsp;&nbsp;
                 </td>
                 <td class="name">
                    &nbsp;&nbsp;&nbsp;&nbsp;
                 </td>
                 <td class="name">
                    &nbsp;&nbsp;&nbsp;&nbsp;
                 </td>
            </tr>
            <tr>
                <td class="text">
                  15:00-16:00
                </td>
                <td class="name">
                   &nbsp;&nbsp;&nbsp;&nbsp;
                </td>
                <td class="name">
                    &nbsp;&nbsp;&nbsp;&nbsp;
                 </td>
                 <td class="name">
                    &nbsp;&nbsp;&nbsp;&nbsp;
                 </td>
                 <td class="name">
                    &nbsp;&nbsp;&nbsp;&nbsp;
                 </td>
                 <td class="name">
                    &nbsp;&nbsp;&nbsp;&nbsp;
                 </td>
                 <td class="name">
                    &nbsp;&nbsp;&nbsp;&nbsp;
                 </td>
                 <td class="name">
                    &nbsp;&nbsp;&nbsp;&nbsp;
                 </td>
            </tr>
            <tr>
                <td class="text">
                  16:00-17:00
                </td>
                <td class="name">
                   &nbsp;&nbsp;&nbsp;&nbsp;
                </td>
                <td class="name">
                    &nbsp;&nbsp;&nbsp;&nbsp;
                 </td>
                 <td class="name">
                    &nbsp;&nbsp;&nbsp;&nbsp;
                 </td>
                 <td class="name">
                    &nbsp;&nbsp;&nbsp;&nbsp;
                 </td>
                 <td class="name">
                    &nbsp;&nbsp;&nbsp;&nbsp;
                 </td>
                 <td class="name">
                    &nbsp;&nbsp;&nbsp;&nbsp;
                 </td>
                 <td class="name">
                    &nbsp;&nbsp;&nbsp;&nbsp;
                 </td>
            </tr>
            <tr>
                <td class="text">
                  17:00-18:00
                </td>
                <td class="name">
                   &nbsp;&nbsp;&nbsp;&nbsp;
                </td>
                <td class="name">
                    &nbsp;&nbsp;&nbsp;&nbsp;
                 </td>
                 <td class="name">
                    &nbsp;&nbsp;&nbsp;&nbsp;
                 </td>
                 <td class="name">
                    &nbsp;&nbsp;&nbsp;&nbsp;
                 </td>
                 <td class="name">
                    &nbsp;&nbsp;&nbsp;&nbsp;
                 </td>
                 <td class="name">
                    &nbsp;&nbsp;&nbsp;&nbsp;
                 </td>
                 <td class="name">
                    &nbsp;&nbsp;&nbsp;&nbsp;
                 </td>
            </tr>
            <tr>
                <td class="text">
                  18:00-19:00
                </td>
                <td class="name">
                   &nbsp;&nbsp;&nbsp;&nbsp;
                </td>
                <td class="name">
                    &nbsp;&nbsp;&nbsp;&nbsp;
                 </td>
                 <td class="name">
                    &nbsp;&nbsp;&nbsp;&nbsp;
                 </td>
                 <td class="name">
                    &nbsp;&nbsp;&nbsp;&nbsp;
                 </td>
                 <td class="name">
                    &nbsp;&nbsp;&nbsp;&nbsp;
                 </td>
                 <td class="name">
                    &nbsp;&nbsp;&nbsp;&nbsp;
                 </td>
                 <td class="name">
                    &nbsp;&nbsp;&nbsp;&nbsp;
                 </td>
            </tr>
            <tr>
                <td class="text">
                  19:00-20:00
                </td>
                <td class="name">
                   &nbsp;&nbsp;&nbsp;&nbsp;
                </td>
                <td class="name">
                    &nbsp;&nbsp;&nbsp;&nbsp;
                 </td>
                 <td class="name">
                    &nbsp;&nbsp;&nbsp;&nbsp;
                 </td>
                 <td class="name">
                    &nbsp;&nbsp;&nbsp;&nbsp;
                 </td>
                 <td class="name">
                    &nbsp;&nbsp;&nbsp;&nbsp;
                 </td>
                 <td class="name">
                    &nbsp;&nbsp;&nbsp;&nbsp;
                 </td>
                 <td class="name">
                    &nbsp;&nbsp;&nbsp;&nbsp;
                 </td>
            </tr>
    </tbody>
  </table>
  
<div class="names" id="names">
  <!-- <div class="name btn">李名一</div>
  <div class="name btn">杨天宇</div>
  <div class="name btn">诗晚铜</div>
  <div class="name btn">庞家欲</div>
  <div class="name btn">张雨萱</div>
  <div class="name btn">牛林赛</div>
  <div class="name btn">张三</div>
  <div class="name btn">李四</div> -->
</div>


<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <input placeholder="学生姓名" id="needed-name"></input>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" id="close-modal" data-dismiss="modal">关闭</button>
            <button type="button" class="btn btn-primary" id="save-name">保存</button>
          </div>
        </div>
      </div>
</div>

<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/interactjs@1.3/dist/interact.min.js"></script>
  <script>
  interact('.name')
  .draggable({
    // enable inertial throwing
    inertia: true,
    // keep the element within the area of it's parent
    restrict: {
      // restriction: "parent",
      endOnly: true,
      elementRect: { top: 0, left: 0, bottom: 1, right: 1 }
    },
    // enable autoScroll
    autoScroll: true,

    // call this function on every dragmove event
    onmove: dragMoveListener,
    // call this function on every dragend event
    onend: function (event) {
      var textEl = event.target.querySelector('p');
      textEl && (textEl.textContent =
        'moved a distance of '
        + (Math.sqrt(Math.pow(event.pageX - event.x0, 2) +
                     Math.pow(event.pageY - event.y0, 2) | 0))
            .toFixed(2) + 'px');
    }
  });
  function dragMoveListener (event) {
    var target = event.target,
        // keep the dragged position in the data-x/data-y attributes
        x = (parseFloat(target.getAttribute('data-x')) || 0) + event.dx,
        y = (parseFloat(target.getAttribute('data-y')) || 0) + event.dy;

    // translate the element
    target.style.webkitTransform =
    target.style.transform =
      'translate(' + x + 'px, ' + y + 'px)';

    // update the posiion attributes
    target.setAttribute('data-x', x);
    target.setAttribute('data-y', y);
  }

  // this is used later in the resizing and gesture demos
  window.dragMoveListener = dragMoveListener;
  refresh = document.getElementById('refresh');

  refresh.onclick = function(){
     if(confirm('确定重排？')){
        window.location.reload();
     }
  }
  
  window.onload = function() {
   initialNames = ['李名一', '杨天宇','诗晚铜', '庞家欲', '张雨萱', '牛林赛']
   var names = localStorage.getItem('names')
   if(!names) {
      localStorage.setItem('names', JSON.stringify(initialNames))
   } 
   names = JSON.parse(names) || initialNames;
   namesHTML = document.getElementById('names');
   nameHTML = '';
   names.forEach(name=>{
      nameHTML+=`<div class="name btn">${name}</div>`
   })
   namesHTML.innerHTML = nameHTML;

   var saveName = document.getElementById('save-name');
   saveName.onclick = function() {
      var name = $('#needed-name').val();
      var names = JSON.parse(localStorage.getItem('names'))
      if(name) {
         names.push(name);
      }
      localStorage.setItem('names', JSON.stringify(names))
      // var namesHTML = document.getElementById('names');
      var singleNameHTML = `<div class="name btn">${name}</div>`
      $('#names').append(singleNameHTML)
      // namesHTML.appendChild(singleNameHTML);
      var closeModal = document.getElementById('close-modal');
      closeModal.click();
   }
  }
  </script>
</body>
</html>